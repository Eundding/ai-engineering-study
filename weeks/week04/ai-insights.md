# Week 04 - AI Engineering 인사이트

각 팀원이 작성한 study-note를 바탕으로 개인별 인사이트와 학습 내용을 정리합니다.

---

## 김성언 (Kim Seong-Eon)

### 핵심 인사이트
- **프롬프트 엔지니어링의 본질**: 모델 가중치 변경 없이 응답을 조정할 수 있는 가장 쉽고 일반적인 모델 조정 기법
- **컨텍스트 효율성**: NIAH(건초더미 속 바늘) 테스트를 통해 프롬프트의 시작과 끝에 위치한 정보가 중간보다 훨씬 더 잘 인식됨을 확인
- **3단계 방어 체계**: 프롬프트 공격에 대한 방어는 모델 수준, 프롬프트 수준, 시스템 수준에서 통합적으로 이루어져야 함

### 독특한 관점 또는 흥미로운 발견
- **시스템 프롬프트의 우월성**: 시스템 프롬프트가 사용자 프롬프트보다 성능을 향상시키는 이유가 단순히 위치뿐 아니라 모델의 사후 학습과도 관련됨
- **프롬프트 공격의 역설**: 모델이 지시를 잘 따르도록 학습될수록 악의적인 지시도 더 잘 따르게 된다는 딜레마
- **간접 프롬프트 주입**: 수동적 파싱(웹, 깃허브에 숨겨두고 기다림)과 능동적 주입(직접 공격)으로 구분되는 새로운 공격 벡터

### 실무 적용 아이디어
- **프롬프트 분해 전략**: 복잡한 작업을 의도 분류 → 응답 생성 등의 하위 작업으로 나눠 모니터링, 디버깅, 병렬화 효과 달성
- **프롬프트 버전 관리**: 프롬프트를 코드와 분리하여 `prompts.py` 파일로 관리하고 메타데이터 추가
- **방어 시스템 구축**: 격리된 가상 머신에서 코드 실행, 데이터베이스 변경 시 명시적 승인 요구

### 추가 학습이 필요한 부분
- 프롬프트브리더와 텍스트그래드 같은 진화 전략 기반 프롬프트 최적화 도구의 실제 구현
- 이상 탐지 알고리즘을 통한 비정상적 프롬프트 탐지 방법론
- 템플릿 불일치 문제를 자동으로 감지하고 수정하는 방법

---

## 안태현 (Ahn Tae-Hyun)

### 핵심 인사이트
- **프롬프트 엔지니어링의 엄격성**: 체계적인 실험 방법과 평가 과정을 통해 다른 머신러닝 실험처럼 엄격하게 수행 가능
- **채팅 템플릿의 중요성**: 모델별로 다른 채팅 템플릿을 사용하며, 템플릿 오류는 발견하기 어렵지만 성능에 큰 영향
- **지시 계층 구조**: 오픈AI가 제안한 4단계 우선순위(시스템 → 사용자 → 모델 출력 → 도구 출력)로 간접 프롬프트 주입 방어

### 독특한 관점 또는 흥미로운 발견
- **프롬프트 도구의 숨겨진 비용**: 프롬프트 엔지니어링 도구가 사용자 모르게 대량의 API 호출 생성 (30개 예시 × 10개 변이 = 300번 호출)
- **프롬프트브리더의 진화 전략**: 기본 프롬프트에서 변이를 만들고 가장 효과적인 것을 선택해 번식시키는 생물학적 진화 방식
- **거짓 거부율의 중요성**: 위반율뿐 아니라 안전한 요청도 거부하는 빈도를 측정해야 과도한 방어를 방지

### 실무 적용 아이디어
- **템플릿 검증 프로세스**: 모델에 질의를 보내기 전 최종 프롬프트를 출력해 템플릿 일치 확인
- **프롬프트 카탈로그 구축**: 각 프롬프트에 model_name, date_created, application, creator 등 메타데이터 포함
- **단계별 방어 전략**: 모델 파인튜닝(지시 계층) → 프롬프트 설계(명시적 금지사항) → 시스템 설계(격리, 승인)

### 추가 학습이 필요한 부분
- OpenPrompt, DSPy 같은 자동화 도구의 내부 동작 원리와 API 호출 패턴
- 정렬된/정렬되지 않은 지시를 포함하는 파인튜닝 데이터셋 구축 방법
- 확산 모델에서의 학습 데이터 추출 위험성과 GAN 대비 개인정보 보호 취약성

---

## 이은정 (Lee Eun-Jeong)

### 핵심 인사이트
- **컨텍스트 길이의 폭발적 성장**: 5년 내 GPT-2의 1K에서 Gemini 1.5 Pro의 2M으로 2,000배 증가
- **NIAH 테스트의 실용성**: 프롬프트 내 위치 효과를 측정하여 중요한 정보는 시작이나 끝에 배치해야 함
- **자동화된 공격의 위협**: PAIR(Prompt Automatic Iterative Refinement)는 20번 미만 요청으로 탈옥 성공

### 독특한 관점 또는 흥미로운 발견
- **모델의 강건성과 프롬프트 엔지니어링**: 모델이 강력해질수록 프롬프트 변화에 강건해져 시행착오가 줄어듦
- **학습 데이터 추출 가능성**: "poem"이라는 단어를 영원히 반복하라고 요청하면 모델이 지시를 벗어나 학습 데이터 노출
- **확산 모델의 취약성**: 스테이블 디퓨전에서 1,000개 이상의 원본 이미지를 추출 가능, GAN보다 개인정보 보호 취약

### 실무 적용 아이디어
- **CoT 전략 선택**: 단계별 생각 유도 vs 자기 비평 방식 중 애플리케이션 특성에 맞게 선택
- **프롬프트 분해의 균형**: 성능 향상과 지연 시간 증가 사이의 트레이드오프를 고려한 최적화
- **다층 보안 체계**: 입력 필터링(키워드, 공격 패턴) + 출력 검증(PII, 유해 정보) + 사용 패턴 분석

### 추가 학습이 필요한 부분
- RULER 같은 긴 컨텍스트 처리 평가 방법의 구체적 구현
- 사실적 탐색(Factual probing)의 기술적 원리와 관계적 지식 'X [관계] Y' 형식 활용
- 모델의 기억률 측정과 데이터 오염 감지 방법론

---

## 허채연 (Heo Chae-Yeon)

### 핵심 인사이트
- **ICL의 핵심 가치**: 가중치 업데이트 없이 프롬프트 예시만으로 새로운 작업 학습 가능
- **컨텍스트 구성의 중요성**: RAG 파이프라인, 웹 검색 등으로 충분한 컨텍스트 제공이 환각 현상 감소
- **방어의 3단계 체계**: 모델 수준(지시 계층), 프롬프트 수준(명시적 금지), 시스템 수준(격리, 승인)

### 독특한 관점 또는 흥미로운 발견
- **페르소나의 힘**: 모델에게 특정 역할이나 성격을 부여하면 같은 글도 다르게 평가되는 강력한 효과
- **마커의 필요성**: 입력 끝나는 지점을 명확히 표시하지 않으면 모델이 계속 내용을 이어 붙일 수 있음
- **지시 계층의 우선순위**: 외부 도구 출력이 가장 낮은 우선순위로 간접 프롬프트 주입 효과적 차단

### 실무 적용 아이디어
- **프롬프트 메타데이터 관리**: 모델명, 생성일, 목적, 샘플링 파라미터, 입출력 스키마를 `.prompt` 파일로 관리
- **안전 벤치마크 활용**: Advbench, PromptRobust로 시스템 취약점 파악 후 방어 전략 설계
- **계층적 방어 구현**: 모델 파인튜닝(우선순위 학습) → 프롬프트 반복(시스템 지시 앞뒤 배치) → 시스템 격리

### 추가 학습이 필요한 부분
- 프롬프트 카탈로그 시스템의 실제 구현과 검색 기능 설계
- 애매한 요청(안전/위험한 응답 모두 가능)에 대한 모델 학습 방법
- 이상 탐지 알고리즘의 구체적인 특징(feature) 선정과 임계값 설정

---

## 통합 토론 주제

스터디 세션에서 함께 논의하면 좋을 질문들을 자유롭게 추가해주세요.

### 공통 질문
- 프롬프트 엔지니어링 도구(OpenPrompt, DSPy)의 API 호출 폭증 문제를 어떻게 제어할 수 있을까?
- 시스템 프롬프트와 사용자 프롬프트의 최적 배치는 모델마다 다른데, 이를 자동으로 찾아내는 방법은?
- 프롬프트를 코드와 분리해서 관리할 때 버전 관리는 어떤 방식이 가장 효과적일까?

### 심화 토론
- CoT(생각의 사슬)와 자기 비평 방식 중 어떤 상황에서 어떤 방법이 더 효과적일까?
- 간접 프롬프트 주입(수동적 파싱 vs 능동적 주입)을 완벽히 막을 수 있는 방법이 존재할까?
- 모델의 학습 데이터 추출 위험(기억률 1%)을 줄이기 위한 학습 시점 방어 기법은?
- 지시 계층 구조(4단계 우선순위)가 실제로 모든 공격을 효과적으로 막을 수 있을까?

### 다음 주차 연결 포인트
- 6장(RAG/Agents)과 연결: 컨텍스트 구성이 RAG의 핵심, 충분한 컨텍스트로 환각 감소
- 프롬프트 분해 → Agent의 도구 호출 체인으로 확장 가능
- 간접 프롬프트 주입 방어가 RAG 시스템 구축 시 필수 고려사항
- 프롬프트 엔지니어링 모범 사례 → RAG 프롬프트 설계에 직접 적용
